(this["webpackJsonpStrangers Things"]=this["webpackJsonpStrangers Things"]||[]).push([[0],{34:function(e,t,n){"use strict";n.r(t);var s=n(2),c=n(1),r=n(20),o=n.n(r),a=n(7),i=n(4),l=n(5),u=n(3),j=n.n(u),d="https://strangers-things.herokuapp.com/api/".concat("2110-VPI-WEB-PT");function b(){return(b=Object(l.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!localStorage.getItem("myToken")){e.next=7;break}return e.next=4,fetch("".concat(d,"/posts"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("myToken"))}});case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,fetch("".concat(d,"/posts"));case 9:e.t0=e.sent;case 10:return t=e.t0,e.next=13,t.json();case 13:return n=e.sent,e.abrupt("return",n);case 17:throw e.prev=17,e.t1=e.catch(0),e.t1;case 20:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}function p(e){return h.apply(this,arguments)}function h(){return(h=Object(l.a)(j.a.mark((function e(t){var n,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(d,"/users/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 3:return n=e.sent,e.next=6,n.json();case 6:s=e.sent,console.log(s),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("could not register",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function O(e){return fetch("".concat(d,"/users/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return e.data.token?localStorage.setItem("myToken",e.data.token):console.log(e),console.log(e),e})).catch(console.error)}function x(e){return fetch("".concat(d,"/posts"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("myToken"))},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){return console.log(e),e})).catch(console.error)}function m(e){return f.apply(this,arguments)}function f(){return(f=Object(l.a)(j.a.mark((function e(t){var n,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(d,"/posts/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("myToken"))}});case 3:return n=e.sent,e.next=6,n.json();case 6:return s=e.sent,console.log(s),e.abrupt("return",s);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function g(){return(g=Object(l.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!localStorage.getItem("myToken")){e.next=7;break}return e.next=4,fetch("".concat(d,"/users/me"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("myToken"))}});case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,fetch("".concat(d,"/users/me"));case 9:e.t0=e.sent;case 10:return t=e.t0,e.next=13,t.json();case 13:return n=e.sent,e.abrupt("return",n);case 17:throw e.prev=17,e.t1=e.catch(0),e.t1;case 20:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}function v(e,t){return y.apply(this,arguments)}function y(){return(y=Object(l.a)(j.a.mark((function e(t,n){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(d,"/posts/").concat(n,"/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("myToken"))},body:JSON.stringify(t)});case 3:return s=e.sent,e.next=6,s.json();case 6:return e.sent,e.abrupt("return",results);case 11:e.prev=11,e.t0=e.catch(0),console.error("could not send message",e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}var P=n(0),S=function(e){var t=Object(c.useState)([]),n=Object(s.a)(t,2),r=n[0],o=n[1],i=e.setCurrentAuthToken,u=(e.currentAuthToken,e.authToken),d=e.setAuthToken;Object(c.useEffect)((function(){localStorage.getItem("myToken")?i(localStorage.getItem("myToken")):d(null)}),[]);var b=function(){var e=Object(l.a)(j.a.mark((function e(t){var n,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={user:{username:"".concat(x),password:"".concat(v)}},t.preventDefault(),e.next=4,O(n);case 4:s=e.sent,o(s.data),y(""),m(""),d(!0),i(localStorage.getItem("myToken")),s.success&&(document.getElementsByClassName("hidden")[0].className="visible",document.getElementById("float").innerText="".concat(s.data.message),setTimeout((function(){document.getElementById("float").className="hidden"}),5e3));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=Object(c.useState)(""),h=Object(s.a)(p,2),x=h[0],m=h[1],f=Object(c.useState)(""),g=Object(s.a)(f,2),v=g[0],y=g[1];return u?Object(P.jsxs)("div",{id:"loggedIn",children:[Object(P.jsx)("p",{children:r?r.message:""}),Object(P.jsx)("button",{type:"submit",onClick:function(e){e.preventDefault(),localStorage.removeItem("myToken"),i(""),d(null)},children:"Log Out"})]}):Object(P.jsx)("div",{id:"login",children:Object(P.jsxs)("form",{onSubmit:b,children:[Object(P.jsx)("label",{htmlFor:"username",children:"Username:"}),Object(P.jsx)("input",{type:"text",name:"username",value:x,onChange:function(e){m(e.target.value)}}),Object(P.jsx)("label",{htmlFor:"password",children:"Password:"}),Object(P.jsx)("input",{type:"text",name:"password",value:v,onChange:function(e){y(e.target.value)}}),Object(P.jsx)("button",{type:"submit",children:"Submit"}),Object(P.jsx)(a.b,{to:"/register",children:"Need to register?"})]})})},w=n(18),T=function(e){var t=e.loadedPosts,n=e.setLoadedPosts,r=e.setPostsToDisplay,o=Object(c.useState)(""),a=Object(s.a)(o,2),i=a[0],u=a[1],d=Object(c.useState)(""),b=Object(s.a)(d,2),p=b[0],h=b[1],O=Object(c.useState)(""),m=Object(s.a)(O,2),f=m[0],g=m[1],v=Object(c.useState)(""),y=Object(s.a)(v,2),S=y[0],T=y[1],k=Object(c.useState)(!1),C=Object(s.a)(k,2),D=C[0],I=C[1],F=function(){var e=Object(l.a)(j.a.mark((function e(s){var c,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),c={post:{title:"".concat(S),description:"".concat(i),price:"".concat(f),location:"".concat(p),willDeliver:"".concat(D)}},e.next=4,x(c);case 4:o=e.sent,console.log(o),r([o.data.post].concat(Object(w.a)(t))),n([o.data.post].concat(Object(w.a)(t)));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsxs)("aside",{id:"createpost",children:[Object(P.jsx)("h1",{children:"Create Post"}),Object(P.jsxs)("form",{onSubmit:F,children:[Object(P.jsx)("label",{htmlFor:"description",children:"Description:"}),Object(P.jsx)("input",{type:"text",name:"description",value:i,onChange:function(e){u(e.target.value)}}),Object(P.jsx)("label",{htmlFor:"location",children:"Location:"}),Object(P.jsx)("input",{type:"text",name:"location",value:p,onChange:function(e){h(e.target.value)}}),Object(P.jsx)("label",{htmlFor:"price",children:"Price:"}),Object(P.jsx)("input",{type:"text",name:"price",value:f,onChange:function(e){g(e.target.value)}}),Object(P.jsx)("label",{htmlFor:"title",children:"Title:"}),Object(P.jsx)("input",{type:"text",name:"title",value:S,onChange:function(e){T(e.target.value)}}),Object(P.jsx)("label",{htmlFor:"willdeliver",children:"Will Deliver"}),Object(P.jsx)("input",{type:"checkbox",name:"willdeliver",value:D,onChange:function(e){I(e.target.checked)}}),Object(P.jsx)("button",{type:"submit",children:"Submit Post"})]})]})},k=function(e){var t=Object(i.e)(),n=e.postId,s=e.setLoadedPosts,c=e.loadedPosts,r=function(){var e=Object(l.a)(j.a.mark((function e(){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n),t.push("/posts"),e.next=4,m(n);case 4:e.sent.success&&(r=c.filter((function(e){return e._id!==n})),s(r),setPostsToDisplay(r));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(P.jsx)("div",{id:"deletepost",children:Object(P.jsx)("button",{onClick:r,children:"Delete"})})},C=function(e){var t=Object(c.useState)(""),n=Object(s.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(""),i=Object(s.a)(a,2),u=i[0],d=i[1],b=Object(c.useState)(""),p=Object(s.a)(b,2),h=p[0],O=p[1],x=Object(c.useState)(""),m=Object(s.a)(x,2),f=m[0],g=m[1],v=Object(c.useState)(!1),y=Object(s.a)(v,2),S=y[0],w=y[1],T=function(){var e=Object(l.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),{post:{title:"".concat(f),description:"".concat(r),price:"".concat(h),location:"".concat(u),willDeliver:"".concat(S)}};case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsx)("div",{id:"editpost",children:Object(P.jsxs)("form",{onSubmit:T,children:[Object(P.jsx)("label",{htmlFor:"description",children:"Description:"}),Object(P.jsx)("input",{type:"text",name:"description",value:r,onChange:function(e){o(e.target.value)}}),Object(P.jsx)("label",{htmlFor:"location",children:"Location:"}),Object(P.jsx)("input",{type:"text",name:"location",value:u,onChange:function(e){d(e.target.value)}}),Object(P.jsx)("label",{htmlFor:"price",children:"Price:"}),Object(P.jsx)("input",{type:"text",name:"price",value:h,onChange:function(e){O(e.target.value)}}),Object(P.jsx)("label",{htmlFor:"title",children:"Title:"}),Object(P.jsx)("input",{type:"text",name:"title",value:f,onChange:function(e){g(e.target.value)}}),Object(P.jsx)("label",{htmlFor:"willdeliver",children:"Will Deliver"}),Object(P.jsx)("input",{type:"checkbox",name:"willdeliver",value:S,onChange:function(e){w(e.target.checked)}}),Object(P.jsx)("button",{type:"submit",children:"Submit Post"})]})})},D=function(e){var t=e.setPostsToDisplay,n=e.loadedPosts,r=Object(c.useState)(""),o=Object(s.a)(r,2),a=o[0],i=o[1];return Object(P.jsx)("div",{children:Object(P.jsxs)("form",{onSubmit:function(e){var s=n.filter((function(e){return function(e,t){if(e.description.toLowerCase().includes(t.toLowerCase())||e.title.toLowerCase().includes(t.toLowerCase())||e.location.toLowerCase().includes(t.toLowerCase())||e.author.username.toLowerCase().includes(t.toLowerCase()))return!0}(e,a)}));t(a.length?s:n),e.preventDefault(),console.log(a),i("")},children:[Object(P.jsx)("label",{htmlFor:"site-search",children:"Search Posts:"}),Object(P.jsx)("input",{type:"search",id:"site-search",onChange:function(e){i(e.target.value)},value:a}),Object(P.jsx)("button",{type:"submit",children:"Search"})]})})},I=("https://strangers-things.herokuapp.com/api/".concat("2110-VPI-WEB-PT"),function(e){var t=e.postsToDisplay,n=e.setPostsToDisplay,s=e.loadedPosts,r=e.setLoadedPosts;return Object(c.useEffect)((function(){(function(){return b.apply(this,arguments)})().then((function(e){r(e.data.posts),n(e.data.posts),console.log(e)})).catch((function(e){console.error(e)}))}),[]),Object(P.jsx)("div",{id:"postspage",children:Object(P.jsxs)("div",{id:"postsandcreate",children:[Object(P.jsx)(T,{setLoadedPosts:r,loadedPosts:s,setPostsToDisplay:n}),Object(P.jsxs)("div",{id:"posts",children:[Object(P.jsx)("h1",{children:"Posts"}),Object(P.jsx)(D,{loadedPosts:s,setPostsToDisplay:n}),t.map((function(e,t){return Object(P.jsxs)("div",{className:"indvPosts",children:[Object(P.jsx)("p",{children:e.title}),Object(P.jsx)("p",{children:e.author.username}),Object(P.jsx)("p",{children:e.createdAt}),Object(P.jsx)("p",{children:e.price}),Object(P.jsx)("p",{children:e.description}),Object(P.jsx)("p",{children:e.location}),Object(P.jsx)("p",{children:e.willDeliver}),e.isAuthor&&e.messages?e.messages.map((function(e,t){return Object(P.jsx)("div",{children:Object(P.jsxs)("p",{children:["Messages:",e.content]})},"message"+e.post._id+t)})):Object(P.jsx)(P.Fragment,{}),e.isAuthor?Object(P.jsx)(k,{postId:e._id,setLoadedPosts:r,loadedPosts:s}):Object(P.jsx)(P.Fragment,{}),e.isAuthor?Object(P.jsx)(N,{loadedPosts:s,postId:e._id,index:t,setPostsToDisplay:n}):Object(P.jsx)(P.Fragment,{}),e.isAuthor?Object(P.jsx)(C,{}):Object(P.jsx)("p",{}),localStorage.getItem("myToken")&&!e.isAuthor?Object(P.jsx)(A,{postId:e._id}):Object(P.jsx)(P.Fragment,{}),Object(P.jsx)("p",{children:"---------"})]},e._id)}))]})]})})}),F=function(e){var t=Object(c.useState)([]),n=Object(s.a)(t,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){(function(){return g.apply(this,arguments)})().then((function(e){o(e.data),console.log(e.data)})).catch((function(e){console.error(e)}))}),[]),Object(P.jsxs)("div",{children:[Object(P.jsx)("h1",{children:"Profile"}),Object(P.jsxs)("div",{children:[Object(P.jsx)("h3",{children:"My Posts"}),r.posts?r.posts.map((function(e){return e.active?Object(P.jsxs)("div",{children:[Object(P.jsxs)("p",{children:["Post Title:",e.title]}),Object(P.jsxs)("p",{children:["Post Description:",e.description]}),e.messages.map((function(e,t){return Object(P.jsxs)("div",{children:[Object(P.jsxs)("p",{children:["Message ",t+1]}),Object(P.jsxs)("p",{children:["From:",e.fromUser.username]}),Object(P.jsxs)("p",{children:["Message:",e.content]}),Object(P.jsx)("p",{children:"--------"})]})})),Object(P.jsx)("p",{children:"--------"})]},"post"+e._id):Object(P.jsx)(P.Fragment,{})})):Object(P.jsx)("p",{children:"no posts"})]})]})},L=function(e){var t=function(){var e=Object(l.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={user:{username:"".concat(o),password:"".concat(d)}},console.log(o),console.log(d),console.log(x),console.log(n),b(""),a(""),e.next=10,p(n);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n=Object(c.useState)(""),r=Object(s.a)(n,2),o=r[0],a=r[1],i=Object(c.useState)(""),u=Object(s.a)(i,2),d=u[0],b=u[1],h=Object(c.useState)(""),O=Object(s.a)(h,2),x=O[0],m=O[1];return Object(P.jsx)("div",{id:"register",children:Object(P.jsxs)("form",{onSubmit:t,children:[Object(P.jsx)("label",{htmlFor:"username",children:"Username:"}),Object(P.jsx)("input",{type:"text",name:"username",value:o,onChange:function(e){a(e.target.value)}}),Object(P.jsx)("label",{htmlFor:"password",children:"Password:"}),Object(P.jsx)("input",{type:"text",name:"password",value:d,onChange:function(e){b(e.target.value)}}),Object(P.jsx)("label",{htmlFor:"confirm-password",children:"Confirm Password:"}),Object(P.jsx)("input",{type:"text",name:"password",value:x,onChange:function(e){m(e.target.value)}}),Object(P.jsx)("button",{type:"register",children:"Register"})]})})},A=function(e){var t=e.postId,n=Object(c.useState)(""),r=Object(s.a)(n,2),o=r[0],a=r[1],i=function(){var e=Object(l.a)(j.a.mark((function e(n){var s,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),""!==o){e.next=9;break}document.getElementById("float").className="visible",document.getElementById("float").innerText="Message Cannot Be Blank",setTimeout((function(){document.getElementById("float").className="hidden"}),5e3),a(""),p(!1),e.next=18;break;case 9:return s={message:{content:"".concat(o)}},console.log(o),console.log(t),e.next=14,v(s,t);case 14:c=e.sent,a(""),p(!1),c.success&&(document.getElementsByClassName("hidden")[0].className="visible",setTimeout((function(){document.getElementById("float").className="hidden"}),5e3));case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=Object(c.useState)(!1),d=Object(s.a)(u,2),b=d[0],p=d[1];return b?Object(P.jsx)("div",{children:Object(P.jsxs)("form",{onSubmit:i,children:[Object(P.jsx)("label",{htmlFor:"message",children:"Message:"}),Object(P.jsx)("input",{type:"text",name:"message",value:o,onChange:function(e){a(e.target.value)}}),Object(P.jsx)("button",{type:"submit",children:"Send Message"})]})}):Object(P.jsx)("button",{onClick:function(){console.log("clicked"),p(!0)},children:"Send Message"})},N=function(e){var t=e.loadedPosts,n=e.postId,r=e.index,o=Object(c.useState)(!1),i=Object(s.a)(o,2),l=i[0];i[1];return l?Object(P.jsxs)("div",{className:"viewIndPost",children:[Object(P.jsx)("p",{children:t[r].title}),Object(P.jsx)("p",{children:t[r].author.username}),Object(P.jsx)("p",{children:t[r].createdAt}),Object(P.jsx)("p",{children:t[r].price}),Object(P.jsx)("p",{children:t[r].description}),Object(P.jsx)("p",{children:t[r].location}),Object(P.jsx)("p",{children:t[r].willDeliver}),Object(P.jsxs)(a.b,{to:"/posts",children:[" ",Object(P.jsx)("button",{children:"All Posts"})," "]})]},t[r]._id):Object(P.jsx)("div",{id:"viewPost",children:Object(P.jsxs)(a.b,{to:"/posts/".concat(n),children:[" ",Object(P.jsx)("button",{children:"View"})," "]})})},B=function(e){var t=Object(i.f)().id,n=e.setPostsToDisplay,s=e.loadedPosts,c=e.setLoadedPosts;var r=s.filter((function(e){return function(e,t){return e._id.includes(t)}(e,t)}));return console.log(s),r.length?Object(P.jsxs)("div",{className:"indvPosts",children:[Object(P.jsx)("p",{children:r[0].title}),Object(P.jsx)("p",{children:r[0].author.username}),Object(P.jsx)("p",{children:r[0].createdAt}),Object(P.jsx)("p",{children:r[0].price}),Object(P.jsx)("p",{children:r[0].description}),Object(P.jsx)("p",{children:r[0].location}),Object(P.jsx)("p",{children:r[0].willDeliver}),r[0].isAuthor&&r[0].messages?r[0].messages.map((function(e,t){return Object(P.jsx)("div",{children:Object(P.jsxs)("p",{children:["Messages:",e.content]})},"message"+e.post._id+t)})):Object(P.jsx)(P.Fragment,{}),r[0].isAuthor?Object(P.jsx)(k,{postId:r[0]._id,setLoadedPosts:c,loadedPosts:s,setPostsToDisplay:n}):Object(P.jsx)(P.Fragment,{}),Object(P.jsxs)(a.b,{to:"/posts",children:[" ",Object(P.jsx)("button",{children:"View"})," "]})]},r[0]._id):Object(P.jsxs)("div",{children:[Object(P.jsx)("h2",{children:"Post Does Not Exist"}),Object(P.jsxs)(a.b,{to:"/posts",children:[" ",Object(P.jsx)("button",{children:"View"})," "]})]})},E=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1],o=Object(c.useState)([]),l=Object(s.a)(o,2),u=l[0],j=l[1],d=Object(c.useState)(!0),b=Object(s.a)(d,2),p=b[0],h=b[1],O=Object(c.useState)(""),x=Object(s.a)(O,2),m=x[0],f=x[1];return Object(P.jsx)(a.a,{children:Object(P.jsxs)("div",{className:"app",children:[Object(P.jsx)("div",{id:"float",className:"hidden",children:Object(P.jsx)("p",{children:"Confirmed"})}),Object(P.jsxs)("div",{id:"navigation",children:[Object(P.jsx)(a.b,{to:"/",children:"Stranger Things"}),Object(P.jsx)(a.b,{to:"/posts",children:"Posts"}),p?Object(P.jsx)(a.b,{to:"/profile",children:"Profile"}):Object(P.jsx)(P.Fragment,{}),Object(P.jsx)(a.b,{to:"/login",children:p?"Log Out":"Log In"})]}),Object(P.jsxs)("div",{id:"main-section",children:[Object(P.jsx)(i.a,{exact:!0,path:["/","/login"],children:Object(P.jsx)(S,{authToken:p,setAuthToken:h,currentAuthToken:m,setCurrentAuthToken:f})}),Object(P.jsx)(i.a,{exact:!0,path:"/posts",children:Object(P.jsx)(I,{loadedPosts:n,setLoadedPosts:r,postsToDisplay:u,setPostsToDisplay:j})}),Object(P.jsx)(i.a,{path:"/profile",children:Object(P.jsx)(F,{})}),Object(P.jsx)(i.a,{path:"/register",children:Object(P.jsx)(L,{})}),Object(P.jsx)(i.a,{path:"/posts/:id",children:Object(P.jsx)(B,{loadedPosts:n,setLoadedPosts:r,setPostsToDisplay:j})}),Object(P.jsx)(i.a,{path:"/editpost",children:Object(P.jsx)(C,{})})]})]})})};o.a.render(Object(P.jsx)(E,{}),document.getElementById("app"))}},[[34,1,2]]]);
//# sourceMappingURL=main.ee9a630f.chunk.js.map
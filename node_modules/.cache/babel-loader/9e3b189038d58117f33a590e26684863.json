{"ast":null,"code":"var _jsxFileName = \"/Users/kieran/Documents/Full Stack/course_work/Strangers.Things/src/components/LoginForm.js\",\n    _s = $RefreshSig$();\n\nimport { Link } from \"react-router-dom\";\nimport { useEffect, useState } from \"react\";\nimport { callApi } from \"../api\";\nimport Button from '@mui/material/Button';\nimport { buttonBaseClasses, TextField } from \"@mui/material\";\nimport { Box } from \"@mui/system\";\nimport { useHistory } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst LoginForm = props => {\n  _s();\n\n  let history = useHistory();\n  const [loginMessage, setLoginMessage] = useState([]);\n  const setCurrentAuthToken = props.setCurrentAuthToken;\n  const authToken = props.authToken;\n  const setAuthToken = props.setAuthToken; // checks if there is a token currently in local Storage, if so saves it to states\n\n  useEffect(() => {\n    localStorage.getItem(\"myToken\") ? setCurrentAuthToken(localStorage.getItem(\"myToken\")) : setAuthToken(null);\n  }, []);\n\n  const handleLogOut = event => {\n    // clears local storage to remove key and log user out\n    event.preventDefault();\n    localStorage.removeItem(\"myToken\");\n    setCurrentAuthToken(\"\");\n    setAuthToken(null);\n  };\n\n  const handleSubmit = async event => {\n    // takes entered password and username and send to callApi, if succesfull creates a notification, if unsucessful creates notification with the message and redirects page to posts\n    let loginInfo = {\n      user: {\n        username: `${username}`,\n        password: `${password}`\n      }\n    };\n    event.preventDefault();\n    const results = await callApi({\n      url: \"/users/login\",\n      method: \"POST\",\n      body: loginInfo\n    });\n    setLoginMessage(results.data);\n    setPassword(\"\");\n    setUsername(\"\"); // console.log(results)\n\n    if (results.success) {\n      localStorage.setItem(\"myToken\", results.data.token);\n      setCurrentAuthToken(localStorage.getItem(\"myToken\"));\n      document.getElementsByClassName(\"hidden\")[0].className = \"visible\";\n      document.getElementById(\"float\").innerText = `${results.data.message} You will be redirected shortly.`;\n      setTimeout(function () {\n        document.getElementById(\"float\").className = \"hidden\";\n        history.push(\"/posts\");\n      }, 3000);\n      setAuthToken(true);\n    } else {\n      document.getElementsByClassName(\"hidden\")[0].className = \"visible\";\n      document.getElementById(\"float\").innerText = `${results.message}`;\n      setTimeout(function () {\n        document.getElementById(\"float\").className = \"hidden\";\n      }, 4000);\n    }\n  };\n\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n\n  const handleUsernameChange = event => {\n    setUsername(event.target.value);\n  };\n\n  const handlePasswordChange = event => {\n    setPassword(event.target.value);\n  };\n\n  return (// if authentication token already exists displays you are currently logged in and a log out button, if no token is in local storage displays the login form\n    authToken ? /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"loggedin\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: loginMessage ? \"You are currently logged in\" : \"\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: localStorage.getItem(\"myToken\") ? \"To log out please click below\" : \"\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: handleLogOut,\n        variant: \"contained\",\n        color: \"primary\",\n        type: \"submit\",\n        size: \"small\",\n        children: \"Log Out\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"login\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Please login or register below\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        component: \"form\",\n        noValidate: true,\n        autoComplete: \"off\",\n        id: \"loginform\",\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(TextField, {\n          required: true,\n          id: \"loginusername\",\n          label: \"Username:\",\n          value: username,\n          variant: \"standard\",\n          onChange: handleUsernameChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          required: true,\n          id: \"loginpassword\",\n          label: \"Password:\",\n          value: password,\n          variant: \"standard\",\n          type: \"password\",\n          onChange: handlePasswordChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          type: \"submit\",\n          sx: {\n            mt: .5\n          },\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/register\",\n          children: \"Need to register?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this)\n  );\n};\n\n_s(LoginForm, \"BrRb3MvPizk9FmF5JaVK0NuGgqM=\", false, function () {\n  return [useHistory];\n});\n\n_c = LoginForm;\nexport default LoginForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"LoginForm\");","map":{"version":3,"sources":["/Users/kieran/Documents/Full Stack/course_work/Strangers.Things/src/components/LoginForm.js"],"names":["Link","useEffect","useState","callApi","Button","buttonBaseClasses","TextField","Box","useHistory","LoginForm","props","history","loginMessage","setLoginMessage","setCurrentAuthToken","authToken","setAuthToken","localStorage","getItem","handleLogOut","event","preventDefault","removeItem","handleSubmit","loginInfo","user","username","password","results","url","method","body","data","setPassword","setUsername","success","setItem","token","document","getElementsByClassName","className","getElementById","innerText","message","setTimeout","push","handleUsernameChange","target","value","handlePasswordChange","mt"],"mappings":"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","sourcesContent":["import { Link } from \"react-router-dom\"\nimport { useEffect, useState } from \"react\"\nimport { callApi } from \"../api\"\nimport Button from '@mui/material/Button';\nimport { buttonBaseClasses, TextField } from \"@mui/material\";\nimport { Box } from \"@mui/system\";\nimport { useHistory } from \"react-router-dom\";\n\n\nconst LoginForm = (props) => {\n    let history = useHistory()\n    const [loginMessage, setLoginMessage] = useState([])\n    const setCurrentAuthToken = props.setCurrentAuthToken\n    const authToken = props.authToken\n    const setAuthToken = props.setAuthToken\n    // checks if there is a token currently in local Storage, if so saves it to states\n    useEffect(() => {\n        localStorage.getItem(\"myToken\")\n            ?\n            setCurrentAuthToken(localStorage.getItem(\"myToken\"))\n            :\n            setAuthToken(null)\n    }, [])\n\n\n    const handleLogOut = (event) => {\n        // clears local storage to remove key and log user out\n        event.preventDefault()\n        localStorage.removeItem(\"myToken\")\n        setCurrentAuthToken(\"\")\n        setAuthToken(null)\n    }\n\n\n    const handleSubmit = async (event) => {\n        // takes entered password and username and send to callApi, if succesfull creates a notification, if unsucessful creates notification with the message and redirects page to posts\n        let loginInfo = {\n            user: {\n                username: `${username}`,\n                password: `${password}`\n            }\n        }\n        event.preventDefault()\n        const results = await callApi({ url: \"/users/login\", method: \"POST\", body: loginInfo })\n        setLoginMessage(results.data)\n        setPassword(\"\")\n        setUsername(\"\")\n        // console.log(results)\n        if (results.success) {\n            localStorage.setItem(\"myToken\", results.data.token)\n            setCurrentAuthToken(localStorage.getItem(\"myToken\"))\n            document.getElementsByClassName(\"hidden\")[0].className = \"visible\"\n            document.getElementById(\"float\").innerText = `${results.data.message} You will be redirected shortly.`\n            setTimeout(function () {\n                document.getElementById(\"float\").className = \"hidden\";\n                history.push(\"/posts\");\n            }, 3000)\n            setAuthToken(true)\n        } else {\n            document.getElementsByClassName(\"hidden\")[0].className = \"visible\"\n            document.getElementById(\"float\").innerText = `${results.message}`\n            setTimeout(function () {\n                document.getElementById(\"float\").className = \"hidden\";\n            }, 4000)\n        }\n    }\n\n    const [username, setUsername] = useState(\"\")\n    const [password, setPassword] = useState(\"\")\n    const handleUsernameChange = (event) => {\n        setUsername(event.target.value)\n    }\n    const handlePasswordChange = (event) => {\n        setPassword(event.target.value)\n    }\n\n\n\n    return (\n        // if authentication token already exists displays you are currently logged in and a log out button, if no token is in local storage displays the login form\n        authToken ?\n            <div id=\"loggedin\">\n                <p>{loginMessage ? \"You are currently logged in\" : \"\"}</p>\n                <p>{localStorage.getItem(\"myToken\") ? \"To log out please click below\" : \"\"}</p>\n                <Button onClick={handleLogOut} variant=\"contained\" color=\"primary\" type=\"submit\" size=\"small\">Log Out</Button>\n            </div>\n            :\n            <div id=\"login\">\n                <h1>Please login or register below</h1>\n                <Box component=\"form\" noValidate autoComplete=\"off\" id=\"loginform\" onSubmit={handleSubmit}>\n                    <TextField required id=\"loginusername\" label=\"Username:\" value={username} variant=\"standard\" onChange={handleUsernameChange} />\n                    <TextField required id=\"loginpassword\" label=\"Password:\" value={password} variant=\"standard\" type=\"password\" onChange={handlePasswordChange} />\n                    <Button variant=\"contained\" color=\"primary\" type=\"submit\" sx={{ mt: .5 }}>Submit</Button>\n                    <Link to=\"/register\">Need to register?</Link>\n                </Box>\n\n            </div>\n\n    )\n}\n\n\n\n\nexport default LoginForm\n\n\n"]},"metadata":{},"sourceType":"module"}